/* ========================================
   LIVRE 3D ULTRA RÉALISTE - AKAKATSUKI
   Avec couches de pages et animation d'ouverture
   ======================================== */

:root {
	--book-w: 320px;
	--book-h: 450px;
	--book-depth: 40px;
	--cover-color-1: #8B0000;
	--cover-color-2: #4a0000;
	--cover-color-3: #2a0000;
	--gold: #d4af37;
	--gold-light: #f4d03f;
	--paper-1: #f8f4e8;
	--paper-2: #e8dcc8;
	--paper-3: #d8c8b0;
	--ink: #1a0a00;
}

/* ========== OVERLAY ========== */
.book-overlay {
	position: fixed;
	inset: 0;
	background: rgba(0, 0, 0, 0);
	z-index: 50;
	pointer-events: none;
	transition: background 1.2s ease;
}

.book-overlay.active {
	background: rgba(0, 0, 0, 0.92);
	pointer-events: auto;
}

/* ========== WRAPPER DU LIVRE 3D ========== */
.book-wrapper {
	display: flex;
	justify-content: center;
	align-items: center;
	min-height: 60vh;
	perspective: 2000px;
	z-index: 100;
	position: relative;
}

.book-3d {
	width: var(--book-w);
	height: var(--book-h);
	position: relative;
	transform-style: preserve-3d;
	transform: rotateY(0deg) rotateX(0deg);
	cursor: pointer;
	transition: transform 0.5s ease;
}

.book-3d:hover {
	transform: rotateY(-8deg) rotateX(3deg) scale(1.02);
}

/* ========== TRANCHE DU LIVRE (3D) ========== */
.book-spine-3d {
	position: absolute;
	left: 0;
	top: 0;
	width: var(--book-depth);
	height: 100%;
	background: linear-gradient(90deg,
		var(--paper-3) 0%,
		var(--paper-1) 20%,
		var(--paper-2) 50%,
		var(--paper-1) 80%,
		var(--paper-3) 100%
	);
	transform: rotateY(-90deg) translateZ(0px) translateX(calc(var(--book-depth) / -2));
	border-radius: 2px;
	box-shadow: inset 0 0 20px rgba(0,0,0,0.2);
}

/* Lignes de pages sur la tranche */
.book-spine-3d::before {
	content: '';
	position: absolute;
	inset: 10px 5px;
	background: repeating-linear-gradient(
		to bottom,
		transparent 0 2px,
		rgba(0,0,0,0.04) 2px 3px
	);
}

/* ========== PAGES INTÉRIEURES (COUCHES) ========== */
.book-page {
	position: absolute;
	top: 5px;
	left: calc(var(--book-depth) + 5px);
	right: 5px;
	bottom: 5px;
	background: linear-gradient(90deg, var(--paper-2), var(--paper-1));
	border-radius: 0 6px 6px 0;
	transform-origin: left center;
	transform-style: preserve-3d;
	backface-visibility: hidden;
	box-shadow: 
		inset 10px 0 30px rgba(0,0,0,0.1),
		-1px 0 0 rgba(0,0,0,0.05);
}

.page-1 { transform: translateZ(4px); }
.page-2 { transform: translateZ(3px); }
.page-3 { transform: translateZ(2px); }
.page-4 { transform: translateZ(1px); }
.page-5 { transform: translateZ(0px); }

/* ========== COUVERTURE AVANT ========== */
.book-front-cover {
	position: absolute;
	top: 0;
	left: var(--book-depth);
	right: 0;
	bottom: 0;
	background: linear-gradient(145deg,
		var(--cover-color-1) 0%,
		var(--cover-color-2) 40%,
		var(--cover-color-3) 100%
	);
	border: 3px solid var(--cover-color-3);
	border-left: none;
	border-radius: 0 10px 10px 0;
	transform-origin: left center;
	transform-style: preserve-3d;
	transform: translateZ(5px);
	display: flex;
	flex-direction: column;
	justify-content: center;
	align-items: center;
	padding: 2rem;
	box-shadow:
		5px 5px 25px rgba(0,0,0,0.5),
		inset 0 0 80px rgba(0,0,0,0.4),
		inset 0 0 120px rgba(139,0,0,0.2);
	overflow: hidden;
}

/* Effet de relief sur la couverture */
.book-front-cover::before {
	content: '';
	position: absolute;
	inset: 15px;
	border: 2px solid rgba(212,175,55,0.3);
	border-radius: 5px;
	pointer-events: none;
}

.cover-inner {
	display: flex;
	flex-direction: column;
	align-items: center;
	gap: 0.5rem;
	z-index: 2;
}

/* Décorations */
.cover-decoration {
	width: 70%;
	height: 2px;
	background: linear-gradient(90deg, transparent, var(--gold), transparent);
	position: relative;
}

.cover-decoration::before,
.cover-decoration::after {
	content: '◆';
	position: absolute;
	top: 50%;
	transform: translateY(-50%);
	color: var(--gold);
	font-size: 0.7rem;
}
.cover-decoration::before { left: -5px; }
.cover-decoration::after { right: -5px; }

.cover-decoration.top { margin-bottom: 1rem; }
.cover-decoration.bottom { margin-top: 1rem; }

/* Titre */
.book-title {
	color: var(--gold);
	font-family: Georgia, serif;
	font-size: 1.6rem;
	font-weight: bold;
	text-align: center;
	text-shadow: 2px 2px 4px rgba(0,0,0,0.8), 0 0 20px rgba(212,175,55,0.3);
	letter-spacing: 1px;
	line-height: 1.3;
}

.cover-emblem {
	font-size: 3.5rem;
	color: var(--gold);
	text-shadow: 3px 3px 6px rgba(0,0,0,0.8), 0 0 40px rgba(212,175,55,0.4);
	margin: 0.8rem 0;
}

.cover-subtitle {
	color: var(--gold-light);
	font-style: italic;
	font-size: 0.9rem;
	letter-spacing: 2px;
	opacity: 0.8;
}

.click-hint {
	position: absolute;
	bottom: 1.2rem;
	color: var(--gold);
	font-size: 0.8rem;
	opacity: 0.6;
	animation: pulseHint 2s ease-in-out infinite;
}

@keyframes pulseHint {
	0%, 100% { opacity: 0.4; }
	50% { opacity: 1; }
}

/* Couverture arrière */
.book-back-cover {
	position: absolute;
	top: 0;
	left: var(--book-depth);
	right: 0;
	bottom: 0;
	background: linear-gradient(145deg, var(--cover-color-2), var(--cover-color-3));
	border-radius: 0 10px 10px 0;
	transform: translateZ(-5px);
}

/* ========== ANIMATION D'OUVERTURE ========== */
.book-wrapper.opening {
	animation: wrapperZoom 2.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
	z-index: 200;
}

.book-wrapper.opening .book-3d {
	animation: bookRotate 2.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
}

.book-wrapper.opening .book-front-cover {
	animation: coverFlip 2.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
}

.book-wrapper.opening .page-1 {
	animation: pageFlip1 2.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.2s forwards;
}
.book-wrapper.opening .page-2 {
	animation: pageFlip2 2.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.35s forwards;
}
.book-wrapper.opening .page-3 {
	animation: pageFlip3 2.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.5s forwards;
}
.book-wrapper.opening .page-4 {
	animation: pageFlip4 2.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.65s forwards;
}
.book-wrapper.opening .page-5 {
	animation: pageFlip5 2.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.8s forwards;
}

/* Zoom du wrapper */
@keyframes wrapperZoom {
	0% { transform: scale(1); }
	40% { transform: scale(1.4); }
	70% { transform: scale(1.6); }
	100% { transform: scale(1.8); opacity: 0; }
}

/* Rotation du livre */
@keyframes bookRotate {
	0% { transform: rotateY(0deg) rotateX(0deg); }
	30% { transform: rotateY(-5deg) rotateX(2deg); }
	100% { transform: rotateY(0deg) rotateX(0deg); }
}

/* Ouverture de la couverture */
@keyframes coverFlip {
	0% { transform: translateZ(5px) rotateY(0deg); }
	20% { transform: translateZ(20px) rotateY(-30deg); }
	40% { transform: translateZ(40px) rotateY(-80deg); }
	60% { transform: translateZ(50px) rotateY(-130deg); box-shadow: 30px 0 50px rgba(0,0,0,0.4); }
	80% { transform: translateZ(40px) rotateY(-165deg); opacity: 0.8; }
	100% { transform: translateZ(30px) rotateY(-180deg); opacity: 0; }
}

/* Flip des pages en cascade */
@keyframes pageFlip1 {
	0% { transform: translateZ(4px) rotateY(0deg); }
	40% { transform: translateZ(15px) rotateY(-50deg); }
	70% { transform: translateZ(25px) rotateY(-120deg); }
	100% { transform: translateZ(20px) rotateY(-175deg); opacity: 0; }
}

@keyframes pageFlip2 {
	0% { transform: translateZ(3px) rotateY(0deg); }
	40% { transform: translateZ(12px) rotateY(-45deg); }
	70% { transform: translateZ(22px) rotateY(-115deg); }
	100% { transform: translateZ(18px) rotateY(-170deg); opacity: 0; }
}

@keyframes pageFlip3 {
	0% { transform: translateZ(2px) rotateY(0deg); }
	40% { transform: translateZ(10px) rotateY(-40deg); }
	70% { transform: translateZ(18px) rotateY(-110deg); }
	100% { transform: translateZ(15px) rotateY(-165deg); opacity: 0; }
}

@keyframes pageFlip4 {
	0% { transform: translateZ(1px) rotateY(0deg); }
	40% { transform: translateZ(8px) rotateY(-35deg); }
	70% { transform: translateZ(15px) rotateY(-100deg); }
	100% { transform: translateZ(12px) rotateY(-160deg); opacity: 0; }
}

@keyframes pageFlip5 {
	0% { transform: translateZ(0px) rotateY(0deg); }
	40% { transform: translateZ(6px) rotateY(-30deg); }
	70% { transform: translateZ(12px) rotateY(-90deg); }
	100% { transform: translateZ(10px) rotateY(-150deg); opacity: 0; }
}

/* ========== LIVRE OUVERT (CONTENU) ========== */
.book-open {
	display: none;
	position: fixed;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%) scale(0.8);
	width: 95vw;
	max-width: 1300px;
	height: 85vh;
	z-index: 300;
	opacity: 0;
}

.book-open.active {
	display: flex;
	animation: bookReveal 0.8s cubic-bezier(0.23, 1, 0.32, 1) forwards;
}

@keyframes bookReveal {
	0% { opacity: 0; transform: translate(-50%, -50%) scale(0.85) rotateX(8deg); }
	100% { opacity: 1; transform: translate(-50%, -50%) scale(1) rotateX(0); }
}

/* Container pages */
.book-pages {
	display: flex;
	width: 100%;
	height: 100%;
	border-radius: 6px;
	overflow: hidden;
	box-shadow: 0 25px 70px rgba(0,0,0,0.6);
}

/* PAGE GAUCHE = SOMMAIRE */
.left-page {
	width: 35%;
	padding: 2rem;
	overflow-y: auto;
	position: relative;
	background: linear-gradient(to right, var(--paper-2) 0%, var(--paper-1) 3%, var(--paper-1) 97%, var(--paper-2) 100%);
	border-right: 1px solid rgba(139,69,19,0.15);
}

.left-page::before {
	content: '';
	position: absolute;
	top: 8px;
	left: 8px;
	bottom: 8px;
	width: 6px;
	background: linear-gradient(to bottom, var(--cover-color-1), var(--cover-color-2), var(--cover-color-1));
	border-radius: 3px 0 0 3px;
	box-shadow: -2px 0 8px rgba(0,0,0,0.25);
}

.page-texture {
	position: absolute;
	inset: 0;
	opacity: 0.03;
	background: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
	pointer-events: none;
}

.left-page::after {
	content: '';
	position: absolute;
	top: 0;
	right: 0;
	width: 40px;
	height: 100%;
	background: linear-gradient(to left, rgba(0,0,0,0.08), transparent);
	pointer-events: none;
}

/* PAGE DROITE = CONTENU */
.right-page {
	width: 65%;
	padding: 2.5rem 3.5rem;
	overflow-y: auto;
	position: relative;
	background: linear-gradient(to left, var(--paper-2) 0%, var(--paper-1) 3%, var(--paper-1) 100%);
}

.right-page::before {
	content: '';
	position: absolute;
	top: 0;
	left: 0;
	width: 40px;
	height: 100%;
	background: linear-gradient(to right, rgba(0,0,0,0.06), transparent);
	pointer-events: none;
}

.right-page::after {
	display: none;
}

/* ========== CONTENU CHAPITRES ========== */
.chapter-content {
	display: none;
	position: relative;
	z-index: 1;
}

.chapter-content.active {
	display: block;
	animation: fadeSlide 0.5s ease-out;
}

@keyframes fadeSlide {
	0% { opacity: 0; transform: translateY(15px); }
	100% { opacity: 1; transform: none; }
}

/* Header chapitre */
.chapter-header {
	text-align: center;
	margin-bottom: 1.8rem;
}

.chapter-number {
	display: block;
	font-size: 0.95rem;
	color: var(--cover-color-1);
	opacity: 0.6;
	letter-spacing: 4px;
}

.chapter-header h3 {
	color: var(--cover-color-1);
	font-family: Georgia, serif;
	font-size: 2rem;
	font-weight: normal;
	margin: 0.4rem 0;
}

.chapter-kanji {
	display: block;
	font-size: 0.85rem;
	color: var(--cover-color-2);
	opacity: 0.4;
	letter-spacing: 6px;
}

/* Séparateurs */
.decorative-divider {
	text-align: center;
	color: var(--cover-color-1);
	opacity: 0.35;
	margin: 1.8rem 0;
	font-size: 1.1rem;
	letter-spacing: 8px;
}

/* Paragraphes */
.chapter-content p {
	color: var(--ink);
	line-height: 1.9;
	font-size: 1rem;
	text-align: justify;
	margin-bottom: 1.3rem;
	text-indent: 2rem;
	font-family: Georgia, serif;
}

.chapter-content p.first-paragraph::first-letter {
	font-size: 3.5rem;
	float: left;
	line-height: 1;
	padding-right: 0.7rem;
	color: var(--cover-color-1);
	font-weight: bold;
}

/* Styles de texte */
.character-name { color: var(--cover-color-1); font-weight: bold; }
.demon-name { color: #3a0000; font-weight: bold; text-shadow: 0 0 4px rgba(255,0,0,0.25); }
.important-term { color: var(--cover-color-2); font-style: italic; }

/* Citation */
.dramatic-quote {
	font-style: italic;
	font-size: 1.1rem;
	color: var(--cover-color-2);
	text-align: center;
	margin: 2rem 1.5rem;
	padding: 1.2rem;
	border-left: 3px solid var(--cover-color-1);
	border-right: 3px solid var(--cover-color-1);
	background: rgba(139,0,0,0.025);
}

.dramatic-text { text-align: center; font-size: 1.15rem; margin: 1.8rem 0; }
.akakatsuki-name {
	color: var(--cover-color-1);
	font-weight: bold;
	font-size: 1.4rem;
	letter-spacing: 6px;
	text-shadow: 2px 2px 4px rgba(0,0,0,0.25);
}

.chapter-end {
	text-align: center;
	margin-top: 2.5rem;
	padding-top: 1.5rem;
	border-top: 1px solid rgba(139,0,0,0.15);
	color: var(--cover-color-2);
	font-style: italic;
	opacity: 0.6;
}

.coming-soon { text-align: center; color: var(--cover-color-2); font-style: italic; opacity: 0.5; padding: 2.5rem; }
.scroll-decoration { text-align: center; font-size: 2.5rem; opacity: 0.25; }

/* ========== SOMMAIRE ========== */
.sommaire-header { text-align: center; margin-bottom: 1.8rem; padding-bottom: 0.8rem; border-bottom: 2px solid rgba(139,0,0,0.15); }
.kanji-big { display: block; font-size: 2.2rem; color: var(--cover-color-1); opacity: 0.25; }
.sommaire-header h2 { color: var(--cover-color-1); font-family: Georgia, serif; font-size: 1.3rem; font-weight: normal; margin-top: 0.3rem; }

.season { margin-bottom: 1.8rem; }
.season.locked { opacity: 0.35; }
.season-title { display: flex; align-items: center; gap: 0.7rem; color: var(--cover-color-1); font-weight: bold; font-size: 1rem; margin-bottom: 0.8rem; padding-bottom: 0.4rem; border-bottom: 1px solid rgba(139,0,0,0.12); }
.season-icon { font-size: 1.1rem; }

.chapter-list { display: flex; flex-direction: column; gap: 0.2rem; }
.chapter-item { display: flex; align-items: center; gap: 0.8rem; padding: 0.7rem 0.9rem; border-radius: 5px; cursor: pointer; transition: all 0.25s; border: 1px solid transparent; }
.chapter-item:hover { background: rgba(139,0,0,0.04); border-color: rgba(139,0,0,0.08); }
.chapter-item.active { background: rgba(139,0,0,0.08); border-color: var(--cover-color-1); box-shadow: 0 2px 6px rgba(139,0,0,0.12); }
.ch-num { font-size: 1.1rem; color: var(--cover-color-1); opacity: 0.5; min-width: 22px; }
.ch-name { color: var(--ink); font-size: 0.9rem; }
.chapter-item.active .ch-name { color: var(--cover-color-1); font-weight: bold; }

.page-footer { position: absolute; bottom: 1.5rem; left: 50%; transform: translateX(-50%); }
.seal { width: 55px; height: 55px; border: 3px solid var(--cover-color-1); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.6rem; color: var(--cover-color-1); opacity: 0.25; }

/* ========== BOUTON FERMER ========== */
.close-book {
	position: absolute;
	top: 0.8rem;
	left: 1.5rem;
	width: 45px;
	height: 45px;
	border-radius: 50%;
	display: flex;
	align-items: center;
	justify-content: center;
	background: linear-gradient(135deg, var(--cover-color-1), var(--cover-color-2));
	color: var(--gold);
	border: 2px solid var(--gold);
	font-size: 1.1rem;
	cursor: pointer;
	z-index: 100;
	box-shadow: 0 3px 12px rgba(0,0,0,0.35);
	transition: all 0.3s;
}

/* ========== RESPONSIVE ========== */
@media (max-width: 1024px) {
	.book-open { height: auto; min-height: 88vh; }
	.book-pages { flex-direction: column-reverse; }
	.left-page, .right-page { width: 100%; }
	.left-page { min-height: 55vh; padding: 1.8rem; }
	.right-page { max-height: 32vh; border-bottom: 3px solid var(--cover-color-1); }
	.right-page::after { display: none; }
	.book-binding { display: none; }
	.page-footer { display: none; }
}

@media (max-width: 768px) {
	:root { --book-w: 260px; --book-h: 370px; --book-depth: 32px; }
	.book-title { font-size: 1.3rem; }
	.cover-emblem { font-size: 2.8rem; }
	.chapter-header h3 { font-size: 1.5rem; }
	.chapter-content p { font-size: 0.92rem; line-height: 1.75; }
	.left-page { padding: 1.3rem; }
}

/* Scrollbars */
.left-page::-webkit-scrollbar, .right-page::-webkit-scrollbar { width: 6px; }
.left-page::-webkit-scrollbar-track, .right-page::-webkit-scrollbar-track { background: rgba(139,0,0,0.04); }
.left-page::-webkit-scrollbar-thumb, .right-page::-webkit-scrollbar-thumb { background: rgba(139,0,0,0.18); border-radius: 3px; }

/* Accessibilité */
@media (prefers-reduced-motion: reduce) {
	*, *::before, *::after { animation-duration: 0.01ms !important; transition-duration: 0.01ms !important; }
}